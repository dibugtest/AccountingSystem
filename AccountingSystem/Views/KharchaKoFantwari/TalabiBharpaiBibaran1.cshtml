@model List<AccountingSystem.ViewModel.talabiBharpaiVM>

@{
    ViewBag.Title = "Talabi Bharpai";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}
<style>
    #tbl {
        border-collapse: collapse;
        width: 100%;
        font-size: 12px;
    }

        #tbl td, #tbl th {
            border: 1px solid black;
            padding: 1px;
        }

    .alignleft {
        float: left;
        text-align: left;
        width: 50%;
    }

    .alignright {
        float: right;
        text-align: left;
        width: 50%;
    }
</style>
<div class="row" id="printDiv" style="font-size:12px;width:845px;">

    <div style="width:100%;text-align:center;">राष्ट्रिय अभिलेखालय <br />@Model[0].year साल @Model[0].month महिनाको तलबी खर्चको भरपाई</div>
    
    <table id="tbl">
        <tr>
            <th>
               क्र.स.
            </th>
            <th>
              दर्जा
            </th>
            <th>
                कर्मचारीको नाम  </th>
            <th>
               शुरु स्केल
            </th>
            <th>
               ग्रेड
            </th>
            <th>
              जम्मा
            </th>
            <th>
              क.स.को थप
            </th>
            <th>
               बीमा
            </th>
            <th>
                जम्मा
            </th>
            <th>
               महंगी भत्ता
            </th>
            <th>
              जोखिम भत्ता
            </th>
            <th>
                जम्मा तलब भत्ता
            </th>
            <th>
               क.स.को कट्टी
            </th>
            <th>
               सापटी
            </th>
            <th>
               ना.ल. कोष
            </th>
            <th>
              बीमा
            </th>
            <th>
                पारिश्रमिक कर कट्टी
            </th>
            <th>
               सा.सु.कर कट्टी
            </th>
            <th>
                जम्मा कट्टी
            </th>
            <th>
               बाँकी पाउने
            </th>
            <th>
              बुझिलिनेको सहि
            </th>
        </tr>
        @{int i = 1;}
        @foreach (var item in Model)
        {
            <tr>
                <td>
                 @CheckZero(i)
                </td>
                <td>
                    @item.darja
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.fullName)
                </td>
                <td>
                    @CheckZero(item.suruScale)
                </td>
                <td>
                    @CheckZero(Math.Round(item.gradeDar*item.gradeSankhya,2))
                </td>
                <td>
                    @CheckZero(item.suruScaleGrade)
                </td>
                <td>
                    @CheckZero(item.kaSaKoThap)
                </td>
                <td>
                    @CheckZero(item.bima)
                </td>
                <td>
                    @CheckZero(item.suruBimaTotal)
                </td>
                <td>
                    @CheckZero(item.mahangiBhatta)
                </td>
                <td>
                    @CheckZero(item.jokhimBhatta)
                </td>
                <td>
                    @CheckZero(item.talabiBhattaTotal)
                </td>
                <td>
                    @CheckZero(item.kaSaKoKatti)
                </td>
                <td>
                    @CheckZero(item.sapati)
                </td>
                <td>
                    @CheckZero(item.naLaKos)
                </td>
                <td>
                    @CheckZero(2*item.bima)
                </td>
                <td>
                    @CheckZero(item.pariKar)
                </td>
                <td>
                    @CheckZero(item.saSukar)
                </td>
                <td>
                    @CheckZero(item.kattiTotal)
                </td>
                <td>
                    @CheckZero(item.pauneTotal)
                </td>
                <td>
                  
                </td>
            </tr>
            i++;
        }
        <tr>
            <td>
               
            </td>
            <td>
              
            </td>
            <td>
                जम्मा
            </td>
            <td>
                @CheckZero(Model.Sum(m=>m.suruScale))
            </td>
            <td>
                @CheckZero(Math.Round(Model.Sum(m => m.gradeDar*m.gradeSankhya),2))
            </td>
            <td>
                @CheckZero(Model.Sum(m=>m.suruScaleGrade))
            </td>
            <td>
                @CheckZero(Model.Sum(m=>m.kaSaKoThap))
            </td>
            <td>
                @CheckZero(Model.Sum(m=>m.bima))
            </td>
            <td>
                @CheckZero(Model.Sum(m=>m.suruBimaTotal))
            </td>
            <td>
                @CheckZero(Model.Sum(m=>m.mahangiBhatta))
            </td>
            <td>
                @CheckZero(Model.Sum(m=>m.jokhimBhatta))
            </td>
            <td>
                @CheckZero(Model.Sum(m=>m.talabiBhattaTotal))
            </td>
            <td>
                @CheckZero(Model.Sum(m=>m.kaSaKoKatti))
            </td>
            <td>
                @CheckZero(Model.Sum(m=>m.sapati))
            </td>
            <td>
                @CheckZero(Model.Sum(m=>m.naLaKos))
            </td>
            <td>
                @CheckZero(2*Model.Sum(m=>m.bima))
            </td>
            <td>
                @CheckZero(Model.Sum(m=>m.pariKar))
            </td>
            <td>
                @CheckZero(Model.Sum(m=>m.saSukar))
            </td>
            <td>
                @CheckZero(Model.Sum(m=>m.kattiTotal))
            </td>
            <td>
                @CheckZero(Model.Sum(m=>m.pauneTotal))
            </td>
            <td></td>
        </tr>
        <tr>
          
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>पोशाक</td>
            <td>तलब</td>
            <td>महंगी भत्ता</td>
            <td>अन्य सेवा शुल्क</td>
            <td>अन्य भत्ता</td>
            <td>जम्मा</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
           
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            
            <td>@CheckZero((decimal)ViewBag.posak)</td>
            <td>@CheckZero(Model.Sum(m=>m.talabiBhattaTotal)-Model.Where(m=>m.jobType=="करार").Sum(m=>m.suruBimaTotal)-Model.Sum(m=>m.mahangiBhatta)-Model.Sum(m=>m.jokhimBhatta))</td>
            <td>@CheckZero(Model.Sum(m=>m.mahangiBhatta))</td>
            <td>@CheckZero(Model.Where(m=>m.jobType=="करार").Sum(m=>m.suruBimaTotal))</td>
            <td>@CheckZero(Model.Sum(m=>m.jokhimBhatta))</td>
            <td>@CheckZero(Model.Sum(m => m.talabiBhattaTotal))</td>
          

            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>ख.शि.नं</td>
            <td>२११११</td>
            <td>२१११३</td>
            <td>२२४१२</td>
            <td>२१११२</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>

        </tr>
      </table>
    <div style="clear:both;"></div>
    <div style="width:100%;">
        <p class="alignleft">पेश गर्ने:<br /></p>
        <p class="alignright" style="text-align:right;padding-right:20px;">सदर गर्ने<br /></p>
    </div>
    <div style="clear:both;"></div>
    
</div>
<br />
<div class="col-md-12" style="padding-left:200px;">
    @*@Html.ActionLink("Create New", "Fantwari", null, new { @class = "btn btn-primary" })*@
    <input type="submit" class="btn btn-primary" id="btnPrint" value="Print" />
    <input type="submit" class="btn btn-primary" id="btnConvertWord" value="Download Word">
</div>

@helper StringToUnicode(string data)
{
    string uni = "";
    foreach (char c in data)
    {
        var charCode = "U+" + ((int)c).ToString("X4");
        switch (charCode)
        {
            case "U+0030":
                uni += "०";
                break;
            case "U+0031":
                uni += "१";
                break;
            case "U+0032":
                uni += "२";
                break;
            case "U+0033":
                uni += "३";
                break;
            case "U+0034":
                uni += "४";
                break;
            case "U+0035":
                uni += "५";
                break;
            case "U+0036":
                uni += "६";
                break;
            case "U+0037":
                uni += "७";
                break;
            case "U+0038":
                uni += "८";
                break;
            case "U+0039":
                uni += "९";
                break;
            default:
                uni += c;
                break;
        }
    }
    @uni
}
@helper CheckZero(decimal data)
{
    if (data == 0)
    {
        @StringToUnicode("0.00")
    }
    else
    {
        @StringToUnicode(data.ToString())
    }
}


@section Scripts{
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/bundles/jquery.ui")
    @Styles.Render("~/Content/css/jquery.ui")
    <script src="~/Scripts/googoose.js"></script>
    <script language="javascript">
        $(document).ready(function () {

            $("#btnPrint").click(function (e) {
                PrintElem("printDiv");
            });
            function PrintElem(elem) {
                var mywindow = window.open('', 'PRINT', 'height=842,width=595');

                mywindow.document.write('<html><head><style>body {font-size:12px;}#tbl {border-collapse: collapse !important;width: 100%;font-size: 12px;}#tbl td, #tbl th {border: 1px solid black !important;padding: 1px !important;} .alignleft {float: left;text-align: left;width: 33.33333%;}.aligncenter {float: left;text-align: center;width: 33.33333%;}.alignright {float: right;text-align: right;width: 33.33333%;}</style><title></title>');
                mywindow.document.write('</head><body >');
                //mywindow.document.write('<h1>' + document.title  + '</h1>');
                mywindow.document.write(document.getElementById(elem).innerHTML);
                mywindow.document.write('</body></html>');

                mywindow.document.close(); // necessary for IE >= 10
                mywindow.focus(); // necessary for IE >= 10*/

                mywindow.print();
                mywindow.close();

                return true;
            }
            $("#btnConvertWord").click(function (event) {
                $(document).googoose({
                    area: '#printDiv',
                    filename: "तलबी भरपाई",
                    size: '8.27in 11.69in',
                    headermargin: '.01in',
                    footermargin: '.01in'

                });
            });
        });
    </script>
}